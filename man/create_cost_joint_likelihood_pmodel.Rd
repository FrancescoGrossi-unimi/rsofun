% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_cost_function.R
\name{create_cost_joint_likelihood_pmodel}
\alias{create_cost_joint_likelihood_pmodel}
\title{Creates a joint log-likelihood cost function for several setups
and multiple target variables, with their respective validation datasets}
\usage{
create_cost_joint_likelihood_pmodel(params_modl, setup)
}
\arguments{
\item{params_modl}{A list of model parameter values, including \code{'kphio',
'soilm_par_a', 'soilm_par_b', 'tau_acclim_tempstress' }and \code{'par_shape_tempstress'}
in that order.}

\item{setup}{A character string (\code{'BRC'} or \code{'FULL'}) indicating which
parameters are calibrated. For \code{setup = 'BRC'} only the quantum yield
efficiency \code{kphio} is calibrated; for \code{setup = 'FULL'} it also includes
the soil moisture stress parameters \code{soilm_par_a} and \code{soilm_par_b}
for calibration.}
}
\value{
A cost function which computes the log-likelihood of the simulated 
target variables by the P-model versus the observed targets. This cost function 
has as arguments a list of calibratable model parameters \code{par}, a named list of 
data frames of observations \code{obs}, and a named list of data frames of driver 
data \code{drivers}.
}
\description{
Creates a cost function for parameter calibration, keeping non-calibrated
parameter values fixed and calibrating the parameters corresponding to setups
\code{BRC} and \code{FULL} from Stocker et al., 2020 GMD. The cost function
computes the log-likelihood for the p-model fitting two given target variables 
for a given set of parameters.
}
\details{
The resulting cost function performs a P-model run for the value of
\code{par} given as argument and the remaining non-calibratable parameters
are held constant (specified via \code{params_modl}).

The likelihood is calculated assuming that the predicted targets are independent
normally distributed and centered on the observations. The optimization should be run 
using \code{BayesianTools}, and the joint likelihood is maximized. For each target, 
the log-likelihood is computed separately, and then all log-likelihoods are summed.

In arguments \code{obs} and \code{drivers}, the names of their elements must 
coincide with the target variable names (for example, 'gpp' and 'vcmax25'). 
The cost function checks internally that names align. The same column variable 
names must be present in the P-model output and in the validation data.frames.
}
\examples{
\dontrun{
# Set model parameters
pars <- list(
  kphio          = 0.04,
  soilm_par_a    = 2.8,
  soilm_par_b    = 1.7,
  tau_acclim_tempstress  = 7.3,
  par_shape_tempstress   = 0.1
  )

# Write cost function
cost_joint_likelihood_kphio <- create_cost_joint_likelihood_pmodel(
  params_modl = pars,
  setup = 'BRC'
  )
}
}
