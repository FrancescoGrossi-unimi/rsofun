% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_pmodel_f_bysite.R
\name{run_pmodel_f_bysite}
\alias{run_pmodel_f_bysite}
\title{R wrapper for SOFUN P-model}
\usage{
run_pmodel_f_bysite(
  sitename,
  params_siml,
  site_info,
  forcing,
  params_soil,
  params_modl,
  makecheck = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{sitename}{Site name.}

\item{params_siml}{Simulation parameters.
\describe{
      \item{spinup}{A logical value indicating whether this simulation does spin-up.}
      \item{spinupyears}{Number of spin-up years.}
      \item{recycle}{Length of standard recycling period, in days.}
      \item{calc_aet_fapar_vpd}{(not in use)}
      \item{in_ppfd}{A logical value, if soi\code{TRUE} PPFD is a prescribed variable, 
      if \code{FALSE} PPFD is simulated internally.}
      \item{in_netrad}{A logical value indicating whether net radiation is 
      prescribed (\code{TRUE}) or simulated internally (\code{FALSE}).}
      \item{outdt}{An integer indicating the output periodicity.}
      \item{ltre}{A logical value, \code{TRUE} if evergreen tree.}
      \item{ltne}{A logical value, \code{TRUE} if evergreen tree and N-fixing.}
      \item{ltrd}{A logical value, \code{TRUE} if deciduous tree.}
      \item{ltnd}{A logical value, \code{TRUE} if deciduous tree and N-fixing.}
      \item{lgr3}{A logical value, \code{TRUE} if grass with C3 photosynthetic pathway.}
      \item{lgn3}{A logical value, \code{TRUE} if grass with C3 photosynthetic
      pathway and N-fixing.}
      \item{lgr4}{A logical value, \code{TRUE} if grass with C4 photosynthetic pathway.}
}}

\item{site_info}{A list of site meta info. Required:
\describe{
      \item{lon}{Longitud of the site location.}
      \item{lat}{Latitude of the site location.}
      \item{elv}{Elevation of the site location, in meters.}
}}

\item{forcing}{A data frame of forcing climate data, used as input 
(see \code{\link{p_model_drivers}}
for a detailed description of its structure and contents).}

\item{params_soil}{A list of soil texture parameters, for the top and bottom
layer of soil.
\describe{
      \item{fsand}{The fraction of sand in the soil.}
      \item{fclay}{The fraction of clay in the soil.}
      \item{forg}{The fraction of organic matter in the soil.}
      \item{fgravel}{The fraction of gravel in the soil.}
}}

\item{params_modl}{A named list of free (calibratable) model parameters.
\describe{
  \item{kphio}{The quantum yield efficiency at optimal temperature, in mol mol\eqn{^{-1}}.
   When temperature dependence is used, it corresponds to the parameter \eqn{c}.}
  \item{kphio_par_a}{The shape parameter \eqn{a} of the temperature-dependency of
   quantum yield efficiency, given by \eqn{\varphi_0 (T) = a (T - b)^2 + c}. 
   If \code{kphio_par_a = 0} the ORG setup from Stocker et al.
   2020 GMD is used, disabling the temperature dependence.}
  \item{kphio_par_b}{The optimal temperature parameter \eqn{b} of the temperature
   dependent quantum yield efficiency, given by 
   \eqn{\varphi_0 (T) = a (T - b)^2 + c}, in \eqn{^o}C.}
  \item{soilm_thetastar}{The threshold parameter \eqn{\theta^{*}} in the 
   soil moisture stress function. To reproduce the setup specified in Stocker
   et al. 2020 GMD, set \code{soilm_thetastar = 0.6 * rootzone_whc}. To
   turn off the soil moisture stress, set \code{soilm_thetastar = 0}.}
  \item{soilm_betao}{The intercept parameter \eqn{\beta_{0}} in the
   soil moisture stress function. This is the parameter calibrated in Stocker
   et al. 2020 GMD.}
  \item{beta_unitcostratio}{The unit cost of carboxylation, corresponding to
   \eqn{\beta = b / a'} in Eq. 3 of Stocker et al. 2020 GMD.}
  \item{rd_to_vcmax}{Ratio of Rdark (dark respiration) to Vcmax25.}
  \item{tau_acclim}{Acclimation time scale of photosynthesis, in days.}
  \item{kc_jmax}{Parameter for Jmax cost ratio (corresponding to c in Prentice
   et al. 2014).} 
  \item{rootzone_whc}{A numeric value for the water holding capacity (in mm),  
   used for simulating the soil water balance. This parameter should be site-specific.}
}}

\item{makecheck}{A logical specifying whether checks are performed 
to verify forcings and model parameters. \code{TRUE} by default.}

\item{verbose}{A logical specifying whether to print warnings.
Defaults to \code{TRUE}.}
}
\value{
Model output is provided as a tidy dataframe, with columns:
\describe{
  \item{\code{date}}{Date of the observation in YYYY-MM-DD format.}
  \item{\code{year_dec}}{Decimal representation of year and day of the year
     (for example, 2007.000 corresponds to 2007-01-01 and 2007.003 to 2007-01-02.}
  \item{\code{fapar}}{Fraction of photosynthetic active radiation (fAPAR), taking
     values between 0 and 1.}
  \item{\code{gpp}}{Gross Primary Productivity (GPP) for each time stamp 
      (in gC m\eqn{^{-2}} d\eqn{^{-1}}).}
  \item{\code{transp}}{Actual evapotranspiration (AET) (in mm d\eqn{^{-1}}).}
  \item{\code{latenth}}{Latent heat flux (in J m\eqn{^{-2}} d\eqn{^{-1}}).}
  \item{\code{pet}}{Potential evapotranspiration (PET) (in mm d\eqn{^{-1}}).}
  \item{\code{vcmax}}{Maximum rate of RuBisCO carboxylation 
      (Vcmax) (in mol C m\eqn{^{-2}} d\eqn{^{-1}}).}
  \item{\code{jmax}}{Maximum rate of electron transport for RuBP regeneration
      (in mol CO\eqn{_2} m\eqn{^{-2}} s\eqn{^{-1}}).}
  \item{\code{vcmax25}}{Maximum rate of carboxylation (Vcmax), 
      normalised to 25\eqn{^o}C (in mol C m\eqn{^{-2}} d\eqn{^{-1}}).}
  \item{\code{jmax25}}{Maximum rate of electron transport, normalised to 
      25\eqn{^o}C (in mol C m\eqn{^{-2}} s\eqn{^{-1}}).}
  \item{\code{gs_accl}}{Acclimated stomatal conductance (in 
      mol C m\eqn{^{−2}} d\eqn{^{−1}} Pa\eqn{^{−1}}).}
  \item{\code{wscal}}{Relative soil water content, between 0 (permanent wilting 
      point, PWP) and 1 (field capacity, FC).}
  \item{\code{chi}}{Ratio of leaf-internal to ambient CO\eqn{_{2}}, ci:ca (unitless).}
  \item{\code{iwue}}{Intrinsic water use efficiency (iWUE) (in Pa).}
  \item{\code{rd}}{Dark respiration (Rd) in gC m\eqn{^{-2}} d\eqn{^{-1}}.}
  \item{\code{tsoil}}{Soil temperature, in \eqn{^{o}}C.}
  }
}
\description{
Call to the Fortran P-model
}
